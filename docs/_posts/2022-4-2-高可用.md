

# MySQL数据库

## **主从分离|读写分离**

设置主从库，往主数据库写，从数据库读

| 性能参数 | 解释                                    | MySQL |
| -------- | --------------------------------------- | ----- |
| TPS      | 每秒事务处理量(TransactionPerSecond)    | 500   |
| QPS      | 每秒查询率（*QPS*，Queries-per-second） | 1000  |

## 



![image-20220819092856127](E:\gitfile\modiman.github.io\docs\_posts\imgs\image-20220819092856127.png)

|      | 主从分离 | 分库分表 |
| ---- | -------- | -------- |
|      | 全量复制 | 分割数据 |
|      |          |          |
|      |          |          |



## 数据库分表

* 数据达到千万级别
* 备份和恢复时间变长
* 不同模块的数据，如用户和商品，如何做到故障隔离
* 写入能力小于读取能力，如何处理高并发写

解决上述问题需要对数据库进行分库分表



**原则**

1. 性能没有瓶颈不需要做
2. 要做就一次到位，做到几年内不用修改
3. NoSQL具有自动分片的功能，如MongoDB,可以考虑替代关系型数据库
4. 

**将数据尽可能平均的分配到多个数据库结点或数据库表中**

### 垂直拆分

将数据库的表拆分到不同数据库中，核心思想是**专库专用**



### 水平拆分

1. 对某个字段做哈希，比如将用户id散列成16段，放进16个数据库
2. 按时间分库，比如一个月的数据放进一个数据库 需要注意的是提前建表

### 数据库中间件

数据库分表后需要注意查询时先要找到数据在哪个库，再到对应的库查找，这个问题可以用数据库中间件解决

### 新问题

引入了分库分表键，也叫分区键
