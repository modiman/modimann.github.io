参考：

* [spring 设计模式](https://www.baeldung.com/spring-framework-design-patterns)

# 引言

设计模式是软件开发的基础部分。这些方法不仅可以解决重复发生的问题，还能帮助开发者通过识别设计模式来理解框架的设计。

本文关注四种Spring框架中最常见的设计模式

1. 单例模式
2. 工厂方法模式
3. 代理模式
4. 模板模式

看看Spring如何使用这些模式去减少开发者的负担并帮助用户快速实施繁琐的任务

## 2. 单例模式

单例模式是一种确保每个应用程序只存在一个对象实例的机制。这种模式在管理共享资源或提供横切服务（例如日志记录）时很有用。

### 2.1. Singleton Beans

通常，单例对于应用程序来说是全局唯一的，但是在 Spring 中，这个约束被放宽了。相反，Spring 将单例限制为每个 Spring IoC 容器一个对象。实际上，这意味着 Spring 只会为每个应用程序上下文的每种类型创建一个 bean。

Spring 的方法不同于对单例的严格定义，因为一个应用程序可以有多个 Spring 容器。因此，如果我们有多个容器，同一类的多个对象可以存在于单个应用程序中。

![]![img](https://www.baeldung.com/wp-content/uploads/2020/02/Singleton.png)

默认情况下，Spring 将所有 bean 创建为单例。

首先，我们创建一个 BookRepository 来管理我们的 Book 域对象。 接下来，我们创建 LibraryController，它使用 BookRepository 返回图书馆中的图书数量：

```java
@RestController
public class LibraryController {
    
    @Autowired
    private BookRepository repository;

    @GetMapping("/count")
    public Long findCount() {
        System.out.println(repository);
        return repository.count();
    }
}
```

最后创建一个BookController，关注于特定书的行为，比如通过ID查找一本书

```java
@RestController
public class BookController {
     
    @Autowired
    private BookRepository repository;
 
    @GetMapping("/book/{id}")
    public Book findById(@PathVariable long id) {
        System.out.println(repository);
        return repository.findById(id).get();
    }
}
```

