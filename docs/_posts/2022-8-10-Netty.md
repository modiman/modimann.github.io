# Netty
**官网解释**：Netty是一个异步事件驱动的网络应用框架，用于快速开发可维护的高性能协议服务器和客户端

Netty提供异步的、事件驱动的网络应用程序框架和工具，用以快速开发高性能、高可靠性的网络服务器和客户端程序。

## 作用
通过定制编解码器实现不同的服务器

* http服务器
* redis服务器
## NIO&BIN



## 面试
* https://author.baidu.com/home?context=%7B%22from%22%3A%22ugc_share%22%2C%22app_id%22%3A%221713966319513702%22%7D
### 对netty的理解
1. 是一个基于NIO模型的高性能网络通信框架，是对NIO网络模型的封装，提供了一个简单易用的api,可以利用这样一个api快速开发自己的网络程序
2. netty在NIO基础上做了很多优化，比如零拷贝机制、高性能无锁队列、内存池，因此性能比NIO更高
3. netty可以支持多种网络协议，比如http,websocket等，并且对拆包、粘包问题内置了拆包策略
### 为什么使用netty
1. 相比于使用jdk自带的NIO相关API来说更加简单，具有以下特点
* 统一的API，支持多种传输类型，比如阻塞、非阻塞，epoll poll等模型，
* 可以使用非常少的代码实现多线程Reactor模型以及主从多线程Reactr模型
* 自带编解码器解决TCP拆包、粘包问题
* 自带各种通信协议，
* 相比于直接使用Java库NIO API 提供了更高的吞吐量， 更低的资源消耗和更少的内存复制
* 安全性很好，有完整的SSL/TLS支持	
* 社区活跃度非常好，版本迭代稳定
### 用Netty可以做什么事情
* 核心问题是解决服务器如何承载更多的用户同时访问的问题
* 由于传统的BIO模型阻塞的特性，在高并发场景中很难去支持更高的吞吐量，
  基于NIO多路复用模型虽然可以优化，但API使用比较复杂

### Netty有哪些核心组件
三层结构构成
#### 网络通信层
1. Bootstrap
负责客户端启动，连接远程netty server，
2. ServerBootstrap
负责服务端监听，用来监听指定的端口
3. Channel
负责网络通信的载体
#### 事件调度层



1. EventLoopGroup
本质上是一个线程池，负责接收IO请求并分配线程执行处理请求

2. EventLoop
相当于线程池里的一个具体线程，
#### 服务编排层
1. ChannelPipline
负责处理多个ChannelHandler,把多个channelHandler构建成一个链，
2. ChannelHandler
针对IO数据的一个处理器，数据接收、处理
3. ChannelHandlerContext
保存CHannelHandler的上下文信息
### Netty有几种线程模型
核心组件
* Reactor
负责将IO事件分派给对应的Handler 
* Acceptor
处理客户端的连接请求
* Handler
执行业务逻辑的读写操作

### Reactor模型中定义的三种角色：

Reactor：负责监听和分配事件，将I/O事件分派给对应的Handler。新的事件包含连接建立就绪、读就绪、写就绪等。

Acceptor：处理客户端新连接，并分派请求到处理器链中。

Handler：将自身与事件绑定，执行非阻塞读/写任务，完成channel的读入，完成处理业务逻辑后，负责将结果写出channel。

1. 单线程单Reactor
如果有Handler出现阻塞，别的任务也不能执行
2. 多线程单Reactor
存在性能瓶颈，吞吐量受到限制
3. 多线程多Reactor（主从）

## 编解码器

在网络中传输数据时，无论以什么的格式发送（int、String、Long等）都会以字节流的方式进行传递。

* 客户端将原来的格式数据转化为字节，称之为编码（encode）。
* 服务端将字节形式转化为原来的格式，称之为解码（decode）。
* 编解码统称为codec ，编码器负责出站数据操作，解码器负责入站数据操作。

**Netty提供的常用解码器有：**

1. RedisDecoder 基于Redis协议的解码器
2. HttpObjectDecoder 基于http协议的解码器
3. XmlDecoder 基于XML格式的解码器

**Netty提供的常用编码器有：**

* ObjectEncoder 将对象（需要实现Serializable接口）编码为字节流

* StringEncoder 将字符串进行编码操作

* RedisEncoder 将Redis协议的对象进行编码

